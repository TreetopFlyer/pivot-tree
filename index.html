<style>
.Row
{
    padding-left:20px;
    overflow:hidden;
    clear:both;
}
.Row > .Name
{
    float:left;
}
.Row > .Columns
{
    float:right;
    overflow:hidden;
}
.Columns > .Cell
{
    width:120px;
    float:left;
    border:1px solid #333;
    padding:5px;

    text-align:right;
}
</style>
<div id="App"></div>
<script type="module">
import { html, render } from 'https://unpkg.com/lit-html/lit-html.js';
import { Pivot, PivotTree, SumRows } from './pivot.js';

const Tier = (inTable, inPath, inApp) =>
{
    var path = inPath.concat([inTable.Name]);
    return html`
    <div class="Row">
        <div class="Name">
            ${inTable.Name}
        </div>
        <div class="Columns">
        ${inTable.Sums.map( (inItem, inIndex)=>{
            var column = inTable.Header[inIndex];
            return html`
            <div class="Cell" @click=${ ()=>{
                inApp.Create(path.concat([column]), 1.33);
                console.log(path.concat([column]));
            } }>
                ${inItem}
            </div>
            `;
        } )}
        </div>
        ${inTable.Children.map( (inItem)=>{
            return Tier(inItem, path);
        } )}
    </div>
    `;
};


var table = {
    Name:"test",
    Header:["Thing", "Type", "Cost", "Count"],
    Sums:[],
    Children:[],
    Rows: [
    ["thing1", "a", 1, 1],
    ["thing1", "b", 2, 1],
    ["thing1", "a", 3, 2],
    ["thing1", "b", 4, 2],
    ["thing2", "a", 1, 2],
    ["thing2", "b", 2, 2],
    ["thing2", "a", 3, 2],
    ["thing2", "b", 4, 2],
    ["thing2", "a", 5, 1],
    ["thing2", "b", 6, 1],
    ["thing2", "a", 7, 1],
    ]
};


var App = {
    Pivot: ["Thing", "Type"],
    Sum: ["Cost", "Count"],
    Edits:[]
};
App.Create = (inPath, inAmount)=>{
    Adjust.Edits.push({Path:inPath, Amount:inAmount});      
};
App.Remove = (inIndex) =>
{

};


SumRows(table, App.Sum);
PivotTree(table, App.Pivot, App.Sum);
console.log(table);
render( Tier(table, []), document.querySelector("#App"));


</script>